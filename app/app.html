<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>MAPED 4</title>

        <link href="stylesheets/main.css" rel="stylesheet" type="text/css">
        <link href="node_modules/jquery-ui/themes/le-frog/jquery-ui.min.css" rel="stylesheet" type="text/css">

        <script src="vendor/electron_boilerplate/env_config.js"></script>
        <script src="vendor/electron_boilerplate/context_menu.js"></script>
        <script src="vendor/electron_boilerplate/external_links.js"></script>

        <script>
            window.jQuery = window.$ = require('jquery');
            require('jquery-ui');

            $(function() {
                $( ".resizable-window" ).resizable();
                $( ".draggable-window" ).draggable();

                window.$MAP_WINDOW = $(".map-palette.resizable-window");

                //$(".map .map_canvas").draggable('disable');
            });

            var myNotification = new Notification('Maped4', {
              body: 'Farmsville map loaded'
            });

            myNotification.onclick = function () {
              console.log('Notification clicked');
            };
        </script>
    </head>
    <body>

        <style>
            body {
                /* le frog*/
                background-color: rgb(51, 51, 51);             
            }

            .map-palette {
                width: 500px;
                height: 500px;
            }

            .tool-palette {
                width: 100px;
                height: 400px;   

                position: absolute; 
                right: 10px;
                top: 10px;
            }

            .layers-palette {
                width: 200px;
                height: 200px;

                position: absolute; 
                right: 10px;
                bottom: 10px;
            }

            .info-palette {
                width: 200px;
                height: 200px;

                position: absolute; 
                right: 220px;
                bottom: 10px;
            }

            /* absolute bullshit for now. */
            .map-palette .map_canvas_container {
                padding-left: 2%;
                width: 95%;
                height: 84%;
            }

            .map-palette .map_canvas {
                width: 100%;
                height: 100%;
            }

            .tooltip-tile-selector {
                width: 40px;
                height: 40px;
                border: solid black 2px;
                position: absolute;
                bottom: 3px;
            }

            .tooltip-tile-selector:enabled {
                border: solid red 3px;
            }

            #left-palette {
                left: 3px;
            }
            #right-palette {
                right: 3px;
            }

            .map-palette.ui-state-disabled {
                opacity: 1;
                filter:Alpha(Opacity=1);                
            }

    
        </style>

        <div class="map-palette ui-widget-content resizable-window draggable-window">
            <h3 class="ui-widget-header">Map</h3>
            <div class="map_canvas_container">
                <canvas class="map_canvas"></canvas>
            </div>
        </div>

        <div class="tool-palette ui-widget-content draggable-window">
            <h3 class="ui-widget-header" id="tool-title">Tool</h3>

            <button id="btn-tool-drag">Drag</button>
            <button id="btn-tool-eyedropper">Eyedropper</button>
            <button id="btn-tool-select" disabled="">Select</button>
            <button id="btn-tool-draw" disabled="">Draw</button>
            <button id="btn-tool-fill" disabled="">Fill</button>
            <button id="btn-tool-zoomin">Zoom In</button>
            <button id="btn-tool-zoomout">Zoom Out</button>

            <canvas id="left-palette" class="tooltip-tile-selector"></canvas>
            <canvas id="right-palette" class="tooltip-tile-selector" disabled=""></canvas>
        </div>

        <div class="layers-palette ui-widget-content draggable-window resizable-window">
            <h3 class="ui-widget-header">Layers</h3>
            <ul class="layers-list">
            </ul>
        </div>

        <div class="info-palette ui-widget-content draggable-window resizable-window">
            <h3 class="ui-widget-header">Info</h3>
            <ul>
                <li>map: <span id="info-mapname"></span></li>
                <li>dims: <span id="info-dims"></span></li>
                <li>loc: <span id="info-location"></span></li>
                <li>zoomlevel: <span id="info-zoom"></span></li>
            </ul>
        </div>

        <script>
            /*
            $(".tooltip-tile-selector").click( function(e) {
                $(".tooltip-tile-selector").attr("selected", "");
                debugger;
            } );
            */

            $("#btn-tool-drag").click( function(e) {
                $("#tool-title").text("Drag");
                window.TOOLMODE = "DRAG";
            } );

            $("#btn-tool-eyedropper").click( function(e) {
                $("#tool-title").text("Eyedropper");
                window.TOOLMODE = "EYEDROPPER";
            } );

            var updateZoomText = function() {

                var txt = (100 / window.currentMap.camera[2]) + "%";

                $("#info-zoom").text(txt);
            };

            $("#btn-tool-zoomin").click( function(e) {
                window.currentMap.grue_zoom(false);
                updateZoomText();                
            } );

            $("#btn-tool-zoomout").click( function(e) {
                window.currentMap.grue_zoom(true);
                updateZoomText();
            } );

            $("#btn-tool-drag").click();
        </script>

        <script src="app.js"></script>
    </body>
</html>
